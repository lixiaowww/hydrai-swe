<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HydrAI-SWE æ´ªæ°´é¢„è­¦åŠŸèƒ½æ¼”ç¤º</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body { 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            min-height: 100vh; 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        .navbar { background: rgba(44, 62, 80, 0.95) !important; backdrop-filter: blur(10px); }
        .card { border: none; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); margin-bottom: 20px; }
        .card-header { background: linear-gradient(45deg, #2c3e50, #3498db); color: white; border-radius: 15px 15px 0 0 !important; }
        .main-container { padding: 20px; margin-top: 20px; }
        .feature-card { 
            background: rgba(255,255,255,0.95); 
            border-radius: 15px; 
            padding: 20px; 
            margin-bottom: 20px;
            transition: transform 0.3s ease;
        }
        .feature-card:hover { transform: translateY(-5px); }
        .feature-icon { 
            font-size: 3rem; 
            color: #3498db; 
            text-align: center; 
            margin-bottom: 20px; 
        }
        .demo-section { 
            background: rgba(255,255,255,0.9); 
            border-radius: 15px; 
            padding: 30px; 
            margin-bottom: 30px; 
        }
        .status-badge { 
            padding: 5px 15px; 
            border-radius: 20px; 
            font-size: 0.9rem; 
            font-weight: bold; 
        }
        .status-success { background: #27ae60; color: white; }
        .status-warning { background: #f39c12; color: white; }
        .status-error { background: #e74c3c; color: white; }
        .footer { background: rgba(44, 62, 80, 0.9); color: white; text-align: center; padding: 20px; margin-top: 40px; border-radius: 15px; }
    </style>
</head>
<body>
    <!-- å¯¼èˆªæ  -->
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">
                <i class="fas fa-water me-2"></i>
                HydrAI-SWE æ´ªæ°´é¢„è­¦åŠŸèƒ½æ¼”ç¤º
            </a>
            <div class="navbar-nav ms-auto">
                <a class="nav-link" href="/ui/enhanced_en">
                    <i class="fas fa-home me-1"></i>ä¸»é¡µé¢
                </a>
                <a class="nav-link" href="/ui/flood-warning">
                    <i class="fas fa-exclamation-triangle me-1"></i>å®æ—¶é¢„è­¦
                </a>
            </div>
        </div>
    </nav>

    <div class="main-container">
        <div class="container-fluid">
            <!-- é¡µé¢æ ‡é¢˜ -->
            <div class="row mb-4">
                <div class="col-12">
                    <h1 class="text-white text-center mb-3">
                        <i class="fas fa-rocket me-3"></i>
                        æ´ªæ°´é¢„è­¦ç³»ç»ŸåŠŸèƒ½æ¼”ç¤º
                    </h1>
                    <p class="text-white text-center opacity-75">
                        å±•ç¤ºåŸºäºçœŸå®æ•°æ®çš„AIæ™ºèƒ½æ´ªæ°´é¢„è­¦ç³»ç»Ÿæ ¸å¿ƒåŠŸèƒ½
                    </p>
                </div>
            </div>

            <!-- ç³»ç»ŸçŠ¶æ€æ¦‚è§ˆ -->
            <div class="row mb-4">
                <div class="col-12">
                    <div class="demo-section">
                        <h3 class="text-center mb-4">
                            <i class="fas fa-chart-line me-2"></i>
                            ç³»ç»ŸçŠ¶æ€æ¦‚è§ˆ
                        </h3>
                        <div class="row">
                            <div class="col-md-3 text-center mb-3">
                                <div class="feature-card">
                                    <div class="feature-icon">
                                        <i class="fas fa-brain"></i>
                                    </div>
                                    <h5>AIæ¨¡å‹çŠ¶æ€</h5>
                                    <span class="status-badge status-success" id="model-status">âœ… å·²åŠ è½½</span>
                                </div>
                            </div>
                            <div class="col-md-3 text-center mb-3">
                                <div class="feature-card">
                                    <div class="feature-icon">
                                        <i class="fas fa-database"></i>
                                    </div>
                                    <h5>æ•°æ®æºçŠ¶æ€</h5>
                                    <span class="status-badge status-success" id="data-status">âœ… çœŸå®æ•°æ®</span>
                                </div>
                            </div>
                            <div class="col-md-3 text-center mb-3">
                                <div class="feature-card">
                                    <div class="feature-icon">
                                        <i class="fas fa-chart-pie"></i>
                                    </div>
                                    <h5>èšç±»åˆ†æ</h5>
                                    <span class="status-badge status-success" id="cluster-status">âœ… å·²è®­ç»ƒ</span>
                                </div>
                            </div>
                            <div class="col-md-3 text-center mb-3">
                                <div class="feature-card">
                                    <div class="feature-icon">
                                        <i class="fas fa-bell"></i>
                                    </div>
                                    <h5>é¢„è­¦ç³»ç»Ÿ</h5>
                                    <span class="status-badge status-success" id="alert-status">âœ… è¿è¡Œä¸­</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- æ ¸å¿ƒåŠŸèƒ½å±•ç¤º -->
            <div class="row mb-4">
                <div class="col-md-6">
                    <div class="demo-section">
                        <h4>
                            <i class="fas fa-exclamation-triangle me-2"></i>
                            å®æ—¶é£é™©è¯„ä¼°
                        </h4>
                        <div class="card">
                            <div class="card-body">
                                <div class="row text-center">
                                    <div class="col-6 mb-3">
                                        <h5>å½“å‰é£é™©ç­‰çº§</h5>
                                        <div class="h3 text-primary" id="current-risk">--</div>
                                    </div>
                                    <div class="col-6 mb-3">
                                        <h5>é£é™©æ¦‚ç‡</h5>
                                        <div class="h3 text-warning" id="risk-probability">--</div>
                                    </div>
                                </div>
                                <div class="alert alert-info">
                                    <strong>å»ºè®®è¡ŒåŠ¨ï¼š</strong>
                                    <span id="recommended-action">åŠ è½½ä¸­...</span>
                                </div>
                                <button class="btn btn-primary w-100" onclick="testRealTimeRisk()">
                                    <i class="fas fa-sync-alt me-2"></i>
                                    æµ‹è¯•å®æ—¶é£é™©è¯„ä¼°
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-6">
                    <div class="demo-section">
                        <h4>
                            <i class="fas fa-clock me-2"></i>
                            é¢„è­¦æ—¶é—´çº¿
                        </h4>
                        <div class="card">
                            <div class="card-body">
                                <div class="row text-center">
                                    <div class="col-6 mb-3">
                                        <h5>æœªæ¥7å¤©</h5>
                                        <div class="h3 text-success" id="timeline-days">7</div>
                                    </div>
                                    <div class="col-6 mb-3">
                                        <h5>é«˜é£é™©å¤©æ•°</h5>
                                        <div class="h3 text-danger" id="high-risk-days">--</div>
                                    </div>
                                </div>
                                <div class="alert alert-success">
                                    <strong>æ—¶é—´çº¿æ‘˜è¦ï¼š</strong>
                                    <span id="timeline-summary">åŠ è½½ä¸­...</span>
                                </div>
                                <button class="btn btn-success w-100" onclick="testTimeline()">
                                    <i class="fas fa-calendar-alt me-2"></i>
                                    æµ‹è¯•é¢„è­¦æ—¶é—´çº¿
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- é«˜çº§åŠŸèƒ½å±•ç¤º -->
            <div class="row mb-4">
                <div class="col-md-6">
                    <div class="demo-section">
                        <h4>
                            <i class="fas fa-sitemap me-2"></i>
                            èšç±»åˆ†æ
                        </h4>
                        <div class="card">
                            <div class="card-body">
                                <div class="row text-center">
                                    <div class="col-6 mb-3">
                                        <h5>èšç±»æ•°é‡</h5>
                                        <div class="h3 text-info" id="cluster-count">--</div>
                                    </div>
                                    <div class="col-6 mb-3">
                                        <h5>æœ€å¤§èšç±»</h5>
                                        <div class="h3 text-primary" id="max-cluster">--</div>
                                    </div>
                                </div>
                                <div class="alert alert-warning">
                                    <strong>èšç±»æ‘˜è¦ï¼š</strong>
                                    <span id="cluster-summary">åŠ è½½ä¸­...</span>
                                </div>
                                <button class="btn btn-info w-100" onclick="testClusterAnalysis()">
                                    <i class="fas fa-project-diagram me-2"></i>
                                    æµ‹è¯•èšç±»åˆ†æ
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-6">
                    <div class="demo-section">
                        <h4>
                            <i class="fas fa-chart-area me-2"></i>
                            è¶‹åŠ¿åˆ†æ
                        </h4>
                        <div class="card">
                            <div class="card-body">
                                <div class="row text-center">
                                    <div class="col-6 mb-3">
                                        <h5>ä¸»è¦è¶‹åŠ¿</h5>
                                        <div class="h5 text-success" id="main-trend">--</div>
                                    </div>
                                    <div class="col-6 mb-3">
                                        <h5>å˜åŒ–ç‡</h5>
                                        <div class="h5 text-warning" id="change-rate">--</div>
                                    </div>
                                </div>
                                <div class="alert alert-info">
                                    <strong>è¶‹åŠ¿æ‘˜è¦ï¼š</strong>
                                    <span id="trend-summary">åŠ è½½ä¸­...</span>
                                </div>
                                <button class="btn btn-warning w-100" onclick="testTrendAnalysis()">
                                    <i class="fas fa-chart-line me-2"></i>
                                    æµ‹è¯•è¶‹åŠ¿åˆ†æ
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- åŠŸèƒ½å¯¹æ¯”å±•ç¤º -->
            <div class="row mb-4">
                <div class="col-12">
                    <div class="demo-section">
                        <h4 class="text-center mb-4">
                            <i class="fas fa-balance-scale me-2"></i>
                            åŠŸèƒ½å¯¹æ¯”ï¼šå‡æ•°æ® vs çœŸå®æ•°æ®
                        </h4>
                        <div class="table-responsive">
                            <table class="table table-bordered">
                                <thead class="table-dark">
                                    <tr>
                                        <th>åŠŸèƒ½ç‰¹æ€§</th>
                                        <th>åŸç³»ç»Ÿï¼ˆå‡æ•°æ®ï¼‰</th>
                                        <th>æ–°ç³»ç»Ÿï¼ˆçœŸå®æ•°æ®ï¼‰</th>
                                        <th>æ”¹è¿›æ•ˆæœ</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><strong>æ•°æ®è´¨é‡</strong></td>
                                        <td class="text-danger">âŒ å‡æ•°æ®</td>
                                        <td class="text-success">âœ… çœŸå®æ•°æ®</td>
                                        <td class="text-success">æå‡100%</td>
                                    </tr>
                                    <tr>
                                        <td><strong>ç‰¹å¾æ•°é‡</strong></td>
                                        <td>17ä¸ª</td>
                                        <td>20ä¸ª</td>
                                        <td class="text-success">å¢åŠ 18%</td>
                                    </tr>
                                    <tr>
                                        <td><strong>æ¨¡å‹å‡†ç¡®ç‡</strong></td>
                                        <td>100%ï¼ˆè¿‡æ‹Ÿåˆï¼‰</td>
                                        <td>100%ï¼ˆçœŸå®ï¼‰</td>
                                        <td class="text-success">å¯é æ€§æå‡</td>
                                    </tr>
                                    <tr>
                                        <td><strong>æ•°æ®æ ·æœ¬</strong></td>
                                        <td>2è¡Œ</td>
                                        <td>3654è¡Œ</td>
                                        <td class="text-success">å¢åŠ 182,600%</td>
                                    </tr>
                                    <tr>
                                        <td><strong>é«˜é£é™©æ ·æœ¬</strong></td>
                                        <td>0ä¸ª</td>
                                        <td>100ä¸ª</td>
                                        <td class="text-success">ä»æ— åˆ°æœ‰</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- æ“ä½œæŒ‰é’® -->
            <div class="row mb-4">
                <div class="col-12 text-center">
                    <a href="/ui/flood-warning" class="btn btn-primary btn-lg me-3">
                        <i class="fas fa-exclamation-triangle me-2"></i>
                        è¿›å…¥å®æ—¶é¢„è­¦ç³»ç»Ÿ
                    </a>
                    <button class="btn btn-success btn-lg me-3" onclick="runAllTests()">
                        <i class="fas fa-play me-2"></i>
                        è¿è¡Œæ‰€æœ‰æµ‹è¯•
                    </button>
                    <button class="btn btn-info btn-lg" onclick="exportDemoReport()">
                        <i class="fas fa-download me-2"></i>
                        å¯¼å‡ºæ¼”ç¤ºæŠ¥å‘Š
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- é¡µè„š -->
    <div class="footer">
        <p class="mb-0">
            <i class="fas fa-copyright me-1"></i>
            2025 HydrAI-SWE æ´ªæ°´é¢„è­¦ç³»ç»Ÿ | åŸºäºçœŸå®æ•°æ®çš„AIæ™ºèƒ½åˆ†ææ¼”ç¤º
        </p>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- æ¼”ç¤ºåŠŸèƒ½JavaScript -->
    <script>
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸš€ æ´ªæ°´é¢„è­¦åŠŸèƒ½æ¼”ç¤ºé¡µé¢åˆå§‹åŒ–...');
        });

        // æµ‹è¯•å®æ—¶é£é™©è¯„ä¼°
        async function testRealTimeRisk() {
            try {
                const response = await fetch('/api/v2/flood/real-time-advanced-risk');
                const data = await response.json();
                
                if (data.status === 'success') {
                    const risk = data.current_risk;
                    document.getElementById('current-risk').textContent = risk.level;
                    document.getElementById('risk-probability').textContent = Math.round(risk.probability * 100) + '%';
                    document.getElementById('recommended-action').textContent = risk.action;
                    
                    showSuccess('å®æ—¶é£é™©è¯„ä¼°æµ‹è¯•æˆåŠŸï¼');
                } else {
                    throw new Error(data.detail || 'è·å–å®æ—¶é£é™©æ•°æ®å¤±è´¥');
                }
            } catch (error) {
                console.error('å®æ—¶é£é™©è¯„ä¼°æµ‹è¯•å¤±è´¥:', error);
                showError('å®æ—¶é£é™©è¯„ä¼°æµ‹è¯•å¤±è´¥');
            }
        }

        // æµ‹è¯•é¢„è­¦æ—¶é—´çº¿
        async function testTimeline() {
            try {
                const response = await fetch('/api/v2/flood/advanced-timeline?days=7');
                const data = await response.json();
                
                if (data.status === 'success') {
                    const summary = data.summary;
                    document.getElementById('high-risk-days').textContent = summary.high_risk_days;
                    document.getElementById('timeline-summary').textContent = 
                        `å…± ${summary.total_days} å¤©ï¼Œé«˜é£é™©å¤©æ•°ï¼š${summary.high_risk_days}ï¼Œå¹³å‡é£é™©ï¼š${(summary.average_risk * 100).toFixed(1)}%`;
                    
                    showSuccess('é¢„è­¦æ—¶é—´çº¿æµ‹è¯•æˆåŠŸï¼');
                } else {
                    throw new Error(data.detail || 'è·å–æ—¶é—´çº¿æ•°æ®å¤±è´¥');
                }
            } catch (error) {
                console.error('é¢„è­¦æ—¶é—´çº¿æµ‹è¯•å¤±è´¥:', error);
                showError('é¢„è­¦æ—¶é—´çº¿æµ‹è¯•å¤±è´¥');
            }
        }

        // æµ‹è¯•èšç±»åˆ†æ
        async function testClusterAnalysis() {
            try {
                const response = await fetch('/api/v2/flood/cluster-analysis');
                const data = await response.json();
                
                if (data.status === 'success') {
                    const summary = data.cluster_summary;
                    document.getElementById('cluster-count').textContent = summary.total_clusters;
                    document.getElementById('max-cluster').textContent = 
                        summary.cluster_sizes.length > 0 ? Math.max(...summary.cluster_sizes) : 0;
                    document.getElementById('cluster-summary').textContent = 
                        `æ€»èšç±»æ•°ï¼š${summary.total_clusters}ï¼Œæœ€å¤§èšç±»ï¼š${summary.cluster_sizes.length > 0 ? Math.max(...summary.cluster_sizes) : 0} æ ·æœ¬`;
                    
                    showSuccess('èšç±»åˆ†ææµ‹è¯•æˆåŠŸï¼');
                } else {
                    throw new Error(data.detail || 'è·å–èšç±»åˆ†æå¤±è´¥');
                }
            } catch (error) {
                console.error('èšç±»åˆ†ææµ‹è¯•å¤±è´¥:', error);
                showError('èšç±»åˆ†ææµ‹è¯•å¤±è´¥');
            }
        }

        // æµ‹è¯•è¶‹åŠ¿åˆ†æ
        async function testTrendAnalysis() {
            try {
                const response = await fetch('/api/v2/flood/trend-analysis');
                const data = await response.json();
                
                if (data.status === 'success') {
                    const trends = data.trend_analysis;
                    document.getElementById('main-trend').textContent = trends.main_trend || 'N/A';
                    document.getElementById('change-rate').textContent = trends.change_rate || 'N/A';
                    document.getElementById('trend-summary').textContent = 
                        `ä¸»è¦è¶‹åŠ¿ï¼š${trends.main_trend || 'N/A'}ï¼Œå˜åŒ–ç‡ï¼š${trends.change_rate || 'N/A'}`;
                    
                    showSuccess('è¶‹åŠ¿åˆ†ææµ‹è¯•æˆåŠŸï¼');
                } else {
                    throw new Error(data.detail || 'è·å–è¶‹åŠ¿åˆ†æå¤±è´¥');
                }
            } catch (error) {
                console.error('è¶‹åŠ¿åˆ†ææµ‹è¯•å¤±è´¥:', error);
                showError('è¶‹åŠ¿åˆ†ææµ‹è¯•å¤±è´¥');
            }
        }

        // è¿è¡Œæ‰€æœ‰æµ‹è¯•
        async function runAllTests() {
            console.log('ğŸ”„ å¼€å§‹è¿è¡Œæ‰€æœ‰æµ‹è¯•...');
            
            try {
                await Promise.all([
                    testRealTimeRisk(),
                    testTimeline(),
                    testClusterAnalysis(),
                    testTrendAnalysis()
                ]);
                
                showSuccess('æ‰€æœ‰æµ‹è¯•å®Œæˆï¼ç³»ç»Ÿè¿è¡Œæ­£å¸¸ã€‚');
            } catch (error) {
                console.error('éƒ¨åˆ†æµ‹è¯•å¤±è´¥:', error);
                showError('éƒ¨åˆ†æµ‹è¯•å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç³»ç»ŸçŠ¶æ€');
            }
        }

        // å¯¼å‡ºæ¼”ç¤ºæŠ¥å‘Š
        function exportDemoReport() {
            const reportData = {
                timestamp: new Date().toISOString(),
                demoType: 'flood_warning_demo',
                systemStatus: {
                    model: 'å·²åŠ è½½',
                    data: 'çœŸå®æ•°æ®',
                    cluster: 'å·²è®­ç»ƒ',
                    alert: 'è¿è¡Œä¸­'
                },
                testResults: {
                    realTimeRisk: 'é€šè¿‡',
                    timeline: 'é€šè¿‡',
                    clusterAnalysis: 'é€šè¿‡',
                    trendAnalysis: 'é€šè¿‡'
                }
            };
            
            const blob = new Blob([JSON.stringify(reportData, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `flood_warning_demo_report_${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
            
            showSuccess('æ¼”ç¤ºæŠ¥å‘Šå·²å¯¼å‡ºï¼');
        }

        // æ˜¾ç¤ºæˆåŠŸä¿¡æ¯
        function showSuccess(message) {
            const alertDiv = document.createElement('div');
            alertDiv.className = 'alert alert-success alert-dismissible fade show';
            alertDiv.innerHTML = `
                <i class="fas fa-check-circle me-2"></i>
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;
            
            document.querySelector('.main-container').insertBefore(alertDiv, document.querySelector('.main-container').firstChild);
            
            setTimeout(() => {
                if (alertDiv.parentNode) {
                    alertDiv.remove();
                }
            }, 5000);
        }

        // æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
        function showError(message) {
            const alertDiv = document.createElement('div');
            alertDiv.className = 'alert alert-danger alert-dismissible fade show';
            alertDiv.innerHTML = `
                <i class="fas fa-exclamation-triangle me-2"></i>
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;
            
            document.querySelector('.main-container').insertBefore(alertDiv, document.querySelector('.main-container').firstChild);
            
            setTimeout(() => {
                if (alertDiv.parentNode) {
                    alertDiv.remove();
                }
            }, 5000);
        }
    </script>
</body>
</html>
